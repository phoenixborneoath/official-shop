<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Checkout — PHOENIXBORNE OATH</title>
  <style>
    .checkout-header {
  position: sticky;
  top: 0;
  z-index: 20;
  backdrop-filter: blur(20px);
  background: linear-gradient(to bottom, rgba(0,0,0,0.85), transparent);
  border-bottom: 1px solid rgba(39, 39, 42, 0.8);
}

.checkout-header-inner {
  max-width: 960px;
  margin: 0 auto;
  padding: 0.9rem 1.25rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
}

.checkout-brand {
  display: flex;
  align-items: center;
  gap: 0.6rem;
}

.checkout-logo {
  height: 32px;
  width: auto;
  object-fit: contain;
}

.checkout-brand span {
  font-size: 0.8rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  font-weight: 600;
  color: #f9fafb;
}

.btn-back {
  padding: 0.45rem 0.9rem;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.2);
  background: rgba(2,6,23,0.9);
  color: #f9fafb;
  font-size: 0.75rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  text-decoration: none;
}

.btn-back:hover {
  border-color: #ef4444;
  box-shadow: 0 0 18px rgba(248,113,113,0.5);
  transform: translateY(-1px);
}
    :root {
      --bg: #020617;
      --bg-soft: #020617;
      --text: #f9fafb;
      --muted: #9ca3af;
      --accent: #ef4444;
      --accent-soft: rgba(248, 113, 113, 0.08);
      --border: #1f2933;
      --radius: 14px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #000;
      color: var(--text);
      min-height: 100vh;
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 1.5rem 1.25rem 3rem;
    }

    h1 {
      font-size: 1.4rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      margin-bottom: 1.5rem;
    }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.2fr);
      gap: 1.8rem;
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: #020617;
      padding: 1.25rem;
    }

    .card h2 {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      margin-bottom: 1rem;
      color: var(--muted);
    }

    .cart-items {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 0.75rem;
      font-size: 0.85rem;
    }

    .cart-item-main {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .cart-name {
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .cart-meta {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .cart-empty {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      margin-top: 0.35rem;
    }

    .summary-label {
      color: var(--muted);
    }

    .summary-value {
      font-weight: 500;
    }

    .summary-total {
      margin-top: 0.6rem;
      padding-top: 0.6rem;
      border-top: 1px dashed var(--border);
      font-size: 0.95rem;
    }

    .summary-total .summary-label {
      color: #e5e7eb;
    }

    .form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      font-size: 0.85rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--muted);
    }

    input,
    textarea,
    select {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #020617;
      padding: 0.55rem 0.8rem;
      font-size: 0.85rem;
      color: var(--text);
      outline: none;
    }

    textarea {
      border-radius: 12px;
      min-height: 80px;
      resize: vertical;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .note-small {
      font-size: 0.75rem;
      color: var(--muted);
    }

    .btn-wa {
      margin-top: 1rem;
      width: 100%;
      padding: 0.7rem 1rem;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: linear-gradient(to right, #22c55e, #16a34a);
      color: #022c22;
      font-size: 0.9rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .btn-wa:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }

    footer {
      max-width: 960px;
      margin: 0 auto;
      padding: 1rem 1.25rem 2rem;
      font-size: 0.72rem;
      color: var(--muted);
      border-top: 1px solid #111827;
      text-align: center;
    }
  </style>
</head>
<body>
  <header class="checkout-header">
  <div class="checkout-header-inner">
    <div class="checkout-brand">
      <img src="images/logo.jpg" alt="Phoenixborne Oath" class="checkout-logo">
      <span>PHOENIXBORNE OATH</span>
    </div>

    <a href="index.html" class="btn-back">
      ← Back to Shop
    </a>
  </div>
</header>

  <main class="page">
    <h1>Checkout</h1>

    <div class="grid">
      <!-- RINGKASAN BELANJA -->
      <section class="card">
        <h2>Ringkasan Order</h2>
        <div id="cartItems" class="cart-items"></div>

        <div class="summary-row">
          <div class="summary-label">Subtotal</div>
          <div class="summary-value" id="subtotalText">Rp 0</div>
        </div>
        <div class="summary-row">
          <div class="summary-label">Ongkir</div>
          <div class="summary-value" id="shippingText">Rp 0</div>
        </div>
        <div class="summary-row summary-total">
          <div class="summary-label">Total Bayar</div>
          <div class="summary-value" id="totalText">Rp 0</div>
        </div>

        <p class="note-small" style="margin-top:0.8rem;">
          Ongkir otomatis berdasarkan provinsi tujuan. Pengiriman dari
          <strong>Sumatra Selatan</strong>. Nominal akhir tetap dikonfirmasi via WhatsApp.
        </p>
      </section>

      <!-- FORM ALAMAT -->
      <section class="card">
        <h2>Data Penerima</h2>
        <form class="form" id="checkoutForm" onsubmit="return false;">
          <div class="field">
            <label for="name">Nama lengkap</label>
            <input id="name" type="text" placeholder="Nama penerima" required />
          </div>

          <div class="field">
            <label for="phone">No. WhatsApp</label>
            <input id="phone" type="tel" placeholder="08xxxxxxxxxx" required />
          </div>

          <div class="field">
            <label for="province">Provinsi</label>
            <select id="province" required>
  <option value="">Pilih provinsi</option>

  <!-- Sumatra -->
  <option value="aceh">Aceh</option>
  <option value="sumut">Sumatra Utara</option>
  <option value="sumbar">Sumatra Barat</option>
  <option value="riau">Riau</option>
  <option value="kepri">Kepulauan Riau</option>
  <option value="jambi">Jambi</option>
  <option value="sumsel">Sumatra Selatan</option>
  <option value="bengkulu">Bengkulu</option>
  <option value="lampung">Lampung</option>
  <option value="babel">Bangka Belitung</option>

  <!-- Kalimantan -->
  <option value="kalbar">Kalimantan Barat</option>
  <option value="kalteng">Kalimantan Tengah</option>
  <option value="kalsel">Kalimantan Selatan</option>
  <option value="kaltim">Kalimantan Timur</option>
  <option value="kalut">Kalimantan Utara</option>

  <!-- Jawa & sekitarnya -->
  <option value="jakarta">DKI Jakarta</option>
  <option value="banten">Banten</option>
  <option value="jabar">Jawa Barat</option>
  <option value="jateng">Jawa Tengah</option>
  <option value="yogya">Yogyakarta</option>
  <option value="jatim">Jawa Timur</option>

  <!-- Bali & Nusa Tenggara -->
  <option value="bali">Bali</option>
  <option value="ntb">Nusa Tenggara Barat</option>
  <option value="ntt">Nusa Tenggara Timur</option>

  <!-- Sulawesi -->
  <option value="sulut">Sulawesi Utara</option>
  <option value="sulbar">Sulawesi Barat</option>
  <option value="sulteng">Sulawesi Tengah</option>
  <option value="sulsel">Sulawesi Selatan</option>
  <option value="sultra">Sulawesi Tenggara</option>
  <option value="gorontalo">Gorontalo</option>

  <!-- Maluku -->
  <option value="maluku">Maluku</option>
  <option value="malut">Maluku Utara</option>

  <!-- Papua (pakai key jelas) -->
  <option value="papua_barat">Papua Barat</option>
  <option value="papua">Papua</option>
  <option value="papua_selatan">Papua Selatan</option>
  <option value="papua_tengah">Papua Tengah</option>
  <option value="papua_pegunungan">Papua Pegunungan</option>
</select>

          </div>

          <div class="field">
            <label for="city">Kota / Kabupaten</label>
            <input id="city" type="text" placeholder="Contoh: Palembang" required />
          </div>

          <div class="field">
            <label for="district">Kecamatan</label>
            <input id="district" type="text" placeholder="Nama kecamatan" required />
          </div>

          <div class="field">
            <label for="postcode">Kode Pos</label>
            <input id="postcode" type="text" placeholder="Kode pos" required />
          </div>

          <div class="field">
            <label for="address">Detail alamat</label>
            <textarea id="address" placeholder="Nama jalan, nomor rumah, patokan, dsb." required></textarea>
          </div>

          <p class="note-small">
            Setelah klik tombol di bawah, kamu akan diarahkan ke WhatsApp resmi
            untuk konfirmasi pesanan & pembayaran.
          </p>

          <button id="waButton" class="btn-wa">Kirim ke WhatsApp</button>
        </form>
      </section>
    </div>
  </main>

  <footer>
    © <span id="yearSpan"></span> PHOENIXBORNE OATH. All Rights Reserved.
  </footer>

  <script>
    // ========= UTIL FORMAT RUPIAH =========
    function formatRupiah(value) {
      return new Intl.NumberFormat("id-ID", {
        style: "currency",
        currency: "IDR",
        maximumFractionDigits: 0,
      }).format(value || 0);
    }

    // ========= LOAD CART DARI localStorage =========
    let cart = [];
    try {
      const raw = localStorage.getItem("pbo_cart");
      cart = raw ? JSON.parse(raw) : [];
    } catch (e) {
      cart = [];
    }

    const cartItemsEl = document.getElementById("cartItems");
    const subtotalText = document.getElementById("subtotalText");
    const shippingText = document.getElementById("shippingText");
    const totalText = document.getElementById("totalText");

    let subtotal = 0;

    function renderCart() {
      if (!cart.length) {
        cartItemsEl.innerHTML = '<div class="cart-empty">Keranjang kosong.</div>';
        subtotal = 0;
        updateTotals();
        return;
      }

      cartItemsEl.innerHTML = "";
      subtotal = 0;

      cart.forEach((entry) => {
        const lineTotal = entry.product.price * entry.qty;
        subtotal += lineTotal;

        const row = document.createElement("div");
        row.className = "cart-item";
        row.innerHTML = `
          <div class="cart-item-main">
            <div class="cart-name">${entry.product.name}</div>
            <div class="cart-meta">
              Size: <strong>${entry.size || "-"}</strong> · Qty: ${entry.qty}
            </div>
          </div>
          <div class="summary-value">${formatRupiah(lineTotal)}</div>
        `;
        cartItemsEl.appendChild(row);
      });

      updateTotals();
    }

    // ========= TABEL ONGKIR (EDIT DI SINI KALAU MAU) =========
    const shippingMap = {
  // Sumatra
  aceh: 70000,
  sumut: 40000,
  sumbar: 38000,
  riau: 40000,
  kepri: 35000,
  jambi: 25000,
  sumsel: 10000,    // kiriman dari Sumatra Selatan -> lebih murah ke lokal
  bengkulu: 30000,
  lampung: 18000,
  babel: 35000,

  // Kalimantan
  kalbar: 50000,
  kalteng: 52000,
  kalsel: 48000,
  kaltim: 58000,
  kalut: 75000,

  // Jawa & sekitarnya
  jakarta: 26000,
  banten: 28000,
  jabar: 30000,
  jateng: 34000,
  yogya: 36000,
  jatim: 38000,

  // Bali & Nusa Tenggara
  bali: 45000,
  ntb: 60000,
  ntt: 90000,

  // Sulawesi
  sulut: 80000,
  sulbar: 75000,
  sulteng: 75000,
  sulsel: 60000,
  sultra: 85000,
  gorontalo: 90000,

  // Maluku
  malut: 120000,
  maluku: 100000,

  // Papua
  papua_barat: 135000,
  papua: 140000,
  papua_selatan: 150000,
  papua_tengah: 150000,
  papua_pegunungan: 170000
};

    function getShippingCost() {
      const prov = document.getElementById("province").value;
      return shippingMap[prov] || 0;
    }

    function updateTotals() {
      const shipping = getShippingCost();
      const total = subtotal + shipping;

      subtotalText.textContent = formatRupiah(subtotal);
      shippingText.textContent = formatRupiah(shipping);
      totalText.textContent = formatRupiah(total);
    }

    // ========= EVENT: UBAH PROVINSI =========
    document.getElementById("province").addEventListener("change", updateTotals);

    // ========= KIRIM KE WHATSAPP =========
    document.getElementById("waButton").addEventListener("click", () => {
  if (!cart.length) {
    alert("Keranjang kosong. Silakan kembali ke halaman shop.");
    return;
  }

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const provinceSelect = document.getElementById("province");
  const provinceLabel = provinceSelect.options[provinceSelect.selectedIndex].text;
  const city = document.getElementById("city").value.trim();
  const district = document.getElementById("district").value.trim();
  const postcode = document.getElementById("postcode").value.trim();
  const address = document.getElementById("address").value.trim();

  // cek field wajib
  if (!name || !phone || !provinceSelect.value || !city || !district || !postcode || !address) {
    alert("Mohon lengkapi semua data pengiriman.");
    return;
  }

  // --- NORMALISASI & VALIDASI NOMOR WA ---
  let phoneDisplay = phone.trim();

  // kalau user isi 08xxxx → jadikan 62xxxx untuk tampilan di pesan WA
  if (/^0\d+/.test(phoneDisplay)) {
    phoneDisplay = "62" + phoneDisplay.slice(1);
  }

  // validasi: hanya angka, panjang 9–15 digit
  const digitsOnly = phone.replace(/\D/g, "");
  if (!/^\d{9,15}$/.test(digitsOnly)) {
    alert("Nomor WA tidak valid. Masukkan angka (contoh: 08xxxxxxxxxx).");
    return;
  }

  // disable tombol supaya tidak diklik berkali-kali
  const waBtn = document.getElementById("waButton");
  waBtn.disabled = true;
  waBtn.style.opacity = 0.7;
  waBtn.style.pointerEvents = "none";

  const shipping = getShippingCost();
  const total = subtotal + shipping;

  // teks order per item (pakai newline biasa)
  const cartLinesPlain = cart
    .map((entry) =>
      `- ${entry.product.name} (Size: ${entry.size || "-"}, Qty: ${entry.qty}) = ${formatRupiah(
        entry.product.price * entry.qty
      )}`
    )
    .join("\n");

  const messagePlain =
    `Halo admin PHOENIXBORNE OATH, saya ingin order:\n` +
    `${cartLinesPlain}\n\n` +
    `Subtotal: ${formatRupiah(subtotal)}\n` +
    `Ongkir (${provinceLabel}): ${formatRupiah(shipping)}\n` +
    `Total Bayar: ${formatRupiah(total)}\n\n` +
    `Data Penerima:\n` +
    `Nama: ${name}\n` +
    `No. WA: ${phoneDisplay}\n` +      // <-- pakai phoneDisplay
    `Provinsi: ${provinceLabel}\n` +
    `Kota/Kab: ${city}\n` +
    `Kecamatan: ${district}\n` +
    `Kode Pos: ${postcode}\n` +
    `Alamat lengkap: ${address}\n\n` +
    `Metode pembayaran: Transfer (konfirmasi via admin).`;

  // GANTI NOMOR INI DENGAN NOMOR WHATSAPP RESMI MU (format 62xxx)
  const waNumber = "62895809679191";

  const waUrl = `https://wa.me/${waNumber}?text=${encodeURIComponent(messagePlain)}`;
  window.open(waUrl, "_blank");

  // kosongkan cart di browser
  localStorage.removeItem("pbo_cart");
  cart = [];
  renderCart();

  // restore button (opsional)
  setTimeout(() => {
    waBtn.disabled = false;
    waBtn.style.opacity = "";
    waBtn.style.pointerEvents = "";
  }, 1000);
});

    // Tahun footer
    document.getElementById("yearSpan").textContent = new Date().getFullYear();

    // Render awal
    renderCart();
  </script>
</body>
</html>
