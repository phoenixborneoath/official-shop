<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Checkout — PHOENIXBORNE OATH</title>
  <style>
    .checkout-header {
  position: sticky;
  top: 0;
  z-index: 20;
  backdrop-filter: blur(20px);
  background: linear-gradient(to bottom, rgba(0,0,0,0.85), transparent);
  border-bottom: 1px solid rgba(39, 39, 42, 0.8);
}

.checkout-header-inner {
  max-width: 960px;
  margin: 0 auto;
  padding: 0.9rem 1.25rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
}

.checkout-brand {
  display: flex;
  align-items: center;
  gap: 0.6rem;
}

.checkout-logo {
  height: 32px;
  width: auto;
  object-fit: contain;
}

.checkout-brand span {
  font-size: 0.8rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  font-weight: 600;
  color: #f9fafb;
}

.btn-back {
  padding: 0.45rem 0.9rem;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.2);
  background: rgba(2,6,23,0.9);
  color: #f9fafb;
  font-size: 0.75rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  text-decoration: none;
}

.btn-back:hover {
  border-color: #ef4444;
  box-shadow: 0 0 18px rgba(248,113,113,0.5);
  transform: translateY(-1px);
}
    :root {
      --bg: #020617;
      --bg-soft: #020617;
      --text: #f9fafb;
      --muted: #9ca3af;
      --accent: #ef4444;
      --accent-soft: rgba(248, 113, 113, 0.08);
      --border: #1f2933;
      --radius: 14px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #000;
      color: var(--text);
      min-height: 100vh;
    }

    .page {
      max-width: 960px;
      margin: 0 auto;
      padding: 1.5rem 1.25rem 3rem;
    }

    h1 {
      font-size: 1.4rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      margin-bottom: 1.5rem;
    }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.2fr);
      gap: 1.8rem;
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: #020617;
      padding: 1.25rem;
    }

    .card h2 {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      margin-bottom: 1rem;
      color: var(--muted);
    }

    .cart-items {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      margin-bottom: 1rem;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 0.75rem;
      font-size: 0.85rem;
    }

    .cart-item-main {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .cart-name {
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .cart-meta {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .cart-empty {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      margin-top: 0.35rem;
    }

    .summary-label {
      color: var(--muted);
    }

    .summary-value {
      font-weight: 500;
    }

    .summary-total {
      margin-top: 0.6rem;
      padding-top: 0.6rem;
      border-top: 1px dashed var(--border);
      font-size: 0.95rem;
    }

    .summary-total .summary-label {
      color: #e5e7eb;
    }

    .form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      font-size: 0.85rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--muted);
    }

    input,
    textarea,
    select {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #020617;
      padding: 0.55rem 0.8rem;
      font-size: 0.85rem;
      color: var(--text);
      outline: none;
    }

    textarea {
      border-radius: 12px;
      min-height: 80px;
      resize: vertical;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .note-small {
      font-size: 0.75rem;
      color: var(--muted);
    }

    .btn-wa {
      margin-top: 1rem;
      width: 100%;
      padding: 0.7rem 1rem;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: linear-gradient(to right, #22c55e, #16a34a);
      color: #022c22;
      font-size: 0.9rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .btn-wa:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }

    footer {
      max-width: 960px;
      margin: 0 auto;
      padding: 1rem 1.25rem 2rem;
      font-size: 0.72rem;
      color: var(--muted);
      border-top: 1px solid #111827;
      text-align: center;
    }
    /* ===== QRIS PAYMENT BOX ===== */
.qris-box {
  display: none;
  margin-top: 16px;
  padding: 14px;
  border-radius: 16px;
  background: #020617;
  border: 1px solid rgba(148,163,184,0.15);
  text-align: center;
}

.qris-img {
  width: 100%;
  max-width: 320px;   /* BESAR & RAPI */
  height: auto;
  display: block;
  margin: 0 auto;
}

.qris-total {
  margin-top: 10px;
  font-size: 1rem;
  font-weight: 700;
  letter-spacing: 0.08em;
}
    .btn-qris-download {
  margin-top: 12px;
  width: 100%;
  padding: 0.6rem 1rem;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.25);
  background: transparent;
  color: #e5e7eb;
  font-size: 0.75rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  cursor: pointer;
}

.btn-qris-download:hover {
  border-color: #38bdf8;
  box-shadow: 0 0 14px rgba(56,189,248,0.35);
}
  </style>
</head>
<body>
  <header class="checkout-header">
  <div class="checkout-header-inner">
    <div class="checkout-brand">
      <img src="images/logo.jpg" alt="Phoenixborne Oath" class="checkout-logo">
      <span>PHOENIXBORNE OATH</span>
    </div>

    <a href="index.html" class="btn-back">
      ← Back to Shop
    </a>
  </div>
</header>

 <main class="page">
  <h1>Checkout</h1>

  <div class="grid">

    <!-- RINGKASAN ORDER -->
    <section class="card">
      <h2>Ringkasan Order</h2>
      <div id="cartItems" class="cart-items"></div>

      <div class="summary-row">
        <span>Subtotal</span>
        <span id="subtotalText">Rp 0</span>
      </div>
      <div class="summary-row">
        <span>Ongkir</span>
        <span id="shippingText">Rp 0</span>
      </div>
      <div class="summary-row summary-total">
        <strong>Total</strong>
        <strong id="totalText">Rp 0</strong>
      </div>
    </section>

    <!-- FORM ALAMAT -->
    <section class="card">
      <h2>Data Penerima</h2>
      <form class="form" id="checkoutForm" onsubmit="return false;">

  <div class="field">
    <label>Nama Lengkap</label>
    <input id="name" required>
  </div>

  <div class="field">
    <label>No. WhatsApp</label>
    <input id="phone" type="tel" required>
  </div>

  <div class="field">
    <label>Provinsi</label>
    <select id="province" required>
      <option value="">Pilih provinsi</option>
      <option value="jakarta">DKI Jakarta</option>
      <option value="jabar">Jawa Barat</option>
      <option value="jateng">Jawa Tengah</option>
      <option value="jatim">Jawa Timur</option>
      <option value="bali">Bali</option>
    </select>
  </div>

  <div class="field">
    <label>Kota / Kabupaten</label>
    <input id="city" required>
  </div>

  <div class="field">
    <label>Kecamatan</label>
    <input id="district" required>
  </div>

  <div class="field">
    <label>Kode Pos</label>
    <input id="postcode" required>
  </div>

  <div class="field">
    <label>Alamat Lengkap</label>
    <textarea id="address" required></textarea>
  </div>

  <hr>

  <div class="field">
    <label>Atas Nama Pengirim</label>
    <input id="payName" required>
  </div>

  <div class="field">
    <label>Metode Pembayaran</label>
    <select id="payMethod" required>
      <option value="">Pilih metode</option>
      <option>QRIS</option>
      <option>BCA Transfer</option>
    </select>
  </div>

  <div class="field">
    <label>Waktu Transfer</label>
    <input id="payTime" type="time" required>
  </div>

  <label class="note-small">
    <input type="checkbox" id="confirmPaid">
    Saya sudah melakukan pembayaran
  </label>

  <!-- QRIS -->
  <div id="qrisBox" class="qris-box">
  <img src="images/qris-bca.png" class="qris-img" id="qrisImage">
  <div id="payTotalQRIS" class="qris-total">Rp 0</div>

  <button type="button" class="btn-qris-download" onclick="downloadQRIS()">
    Download QRIS
  </button>
</div>

  <button id="waButton" class="btn-wa">Kirim ke WhatsApp</button>

</form>

      </section>
    </div>
  </main>

  <footer>
    © <span id="yearSpan"></span> PHOENIXBORNE OATH. All Rights Reserved.
  </footer>

  <script>
    // ========= UTIL FORMAT RUPIAH =========
    function formatRupiah(value) {
      return new Intl.NumberFormat("id-ID", {
        style: "currency",
        currency: "IDR",
        maximumFractionDigits: 0,
      }).format(value || 0);
    }

    // ========= LOAD CART DARI localStorage =========
    let cart = [];
    try {
      const raw = localStorage.getItem("pbo_cart");
      cart = raw ? JSON.parse(raw) : [];
    } catch (e) {
      cart = [];
    }

    let subtotal = 0;
    const cartItemsEl = document.getElementById("cartItems");

   function renderCart() {     
   if (!cart.length) {
    cartItemsEl.innerHTML =
      '<div class="cart-empty">Keranjang kosong.</div>';
    subtotal = 0;
    updateTotals();
    return;
  }

  cartItemsEl.innerHTML = "";
  subtotal = 0;

  cart.forEach((entry) => {
    const lineTotal = entry.product.price * entry.qty;
    subtotal += lineTotal;

    const row = document.createElement("div");
    row.className = "cart-item";
    row.innerHTML = `
      <div class="cart-item-main">
        <div class="cart-name">${entry.product.name}</div>
        <div class="cart-meta">
          Size: <strong>${entry.size || "-"}</strong> · Qty: ${entry.qty}
        </div>
      </div>
      <div class="summary-value">${formatRupiah(lineTotal)}</div>
    `;
    cartItemsEl.appendChild(row);
  });
}
    // ===== ONGKIR & QRIS (GLOBAL) =====
const shippingMap = {
  jakarta: 26000,
  jabar: 30000,
  jateng: 34000,
  jatim: 38000,
  bali: 45000
};

function getShippingCost() {
  const prov = document.getElementById("province").value;
  return shippingMap[prov] || 0;
}

function checkShowQRIS() {
  const fields = [
    "name","phone","province","city",
    "district","postcode","address","payMethod"
  ];

  const filled = fields.every(id =>
    document.getElementById(id)?.value.trim()
  );

  const qris = document.getElementById("qrisBox");
  const totalQRIS = document.getElementById("payTotalQRIS");

  if (filled && document.getElementById("payMethod").value.includes("QRIS")) {
    qris.style.display = "block";
    totalQRIS.textContent =
      formatRupiah(subtotal + getShippingCost());
  } else {
    qris.style.display = "none";
  }
}

    const payTotalEl = document.getElementById("payTotal");
   function updateTotals() {
  const shipping = getShippingCost();
  const total = subtotal + shipping;

  document.getElementById("subtotalText").textContent =
    formatRupiah(subtotal);
  document.getElementById("shippingText").textContent =
    formatRupiah(shipping);
  document.getElementById("totalText").textContent =
    formatRupiah(total);

  checkShowQRIS();
}

    // ========= EVENT: UBAH PROVINSI =========
   document.addEventListener("DOMContentLoaded", () => {
  renderCart();
  updateTotals();
   
  [
    "name","phone","province","city",
    "district","postcode","address","payMethod"
  ].forEach(id => {
    const el = document.getElementById(id);
    if (el) {
      el.addEventListener("input", updateTotals);
      el.addEventListener("change", updateTotals);
    }
  });
});

    // ========= KIRIM KE WHATSAPP =========
    document.getElementById("waButton").addEventListener("click", () => {
  if (!cart.length) {
    alert("Keranjang kosong. Silakan kembali ke halaman shop.");
    return;
  }

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const provinceSelect = document.getElementById("province");
  const provinceLabel = provinceSelect.options[provinceSelect.selectedIndex].text;
  const city = document.getElementById("city").value.trim();
  const district = document.getElementById("district").value.trim();
  const postcode = document.getElementById("postcode").value.trim();
  const address = document.getElementById("address").value.trim();

  // cek field wajib
  if (!name || !phone || !provinceSelect.value || !city || !district || !postcode || !address) {
    alert("Mohon lengkapi semua data pengiriman.");
    return;
  }

  // --- NORMALISASI & VALIDASI NOMOR WA ---
  let phoneDisplay = phone.trim();

  // kalau user isi 08xxxx → jadikan 62xxxx untuk tampilan di pesan WA
  if (/^0\d+/.test(phoneDisplay)) {
    phoneDisplay = "62" + phoneDisplay.slice(1);
  }

  // validasi: hanya angka, panjang 9–15 digit
  const digitsOnly = phone.replace(/\D/g, "");
  if (!/^\d{9,15}$/.test(digitsOnly)) {
    alert("Nomor WA tidak valid. Masukkan angka (contoh: 08xxxxxxxxxx).");
    return;
  }

  // disable tombol supaya tidak diklik berkali-kali
  const waBtn = document.getElementById("waButton");
  waBtn.disabled = true;
  waBtn.style.opacity = 0.7;
  waBtn.style.pointerEvents = "none";

  const shipping = getShippingCost();
  const total = subtotal + shipping;

      // === LIST ITEM ORDER ===
const cartLinesPlain = cart
  .map((entry) =>
    `- ${entry.product.name} (Size: ${entry.size || "-"}, Qty: ${entry.qty}) = ${formatRupiah(
      entry.product.price * entry.qty
    )}`
  )
  .join("\n");


  // === VALIDASI SUDAH TRANSFER ===
if (!document.getElementById("confirmPaid").checked) {
  alert("Silakan lakukan pembayaran terlebih dahulu.");
  waBtn.disabled = false;
  waBtn.style.opacity = "";
  waBtn.style.pointerEvents = "";
  return;
}

const payName = document.getElementById("payName").value.trim();
const payMethod = document.getElementById("payMethod").value;
const payTime = document.getElementById("payTime").value;

if (!payName || !payMethod || !payTime) {
  alert("Lengkapi data konfirmasi pembayaran.");
  waBtn.disabled = false;
  waBtn.style.opacity = "";
  waBtn.style.pointerEvents = "";
  return;
}

// === PESAN WHATSAPP ===
const messagePlain =
`Halo admin PHOENIXBORNE OATH, saya ingin konfirmasi pembayaran.

Order:
${cartLinesPlain}

Subtotal: ${formatRupiah(subtotal)}
Ongkir (${provinceLabel}): ${formatRupiah(shipping)}
Total Bayar: ${formatRupiah(total)}

Data Penerima:
Nama: ${name}
No. WA: ${phoneDisplay}
Provinsi: ${provinceLabel}
Kota/Kab: ${city}
Kecamatan: ${district}
Kode Pos: ${postcode}
Alamat: ${address}

Detail Pembayaran:
Atas Nama: ${payName}
Metode: ${payMethod}
Waktu Transfer: ${payTime}
Nominal: ${formatRupiah(total)}

Mohon dicek, terima kasih.`;

  // GANTI NOMOR INI DENGAN NOMOR WHATSAPP RESMI MU (format 62xxx)
  const waNumber = "62895809679191";

  const waUrl = `https://wa.me/${waNumber}?text=${encodeURIComponent(messagePlain)}`;
  window.open(waUrl, "_blank");

  // restore button (opsional)
  setTimeout(() => {
    waBtn.disabled = false;
    waBtn.style.opacity = "";
    waBtn.style.pointerEvents = "";
  }, 1000);
});

   <script>
  // ===== TAHUN FOOTER =====
  document.getElementById("yearSpan").textContent = new Date().getFullYear();

  // ===== DOWNLOAD QRIS =====
  function downloadQRIS() {
    const img = document.getElementById("qrisImage");
    if (!img) return;

    const link = document.createElement("a");
    link.href = img.src;
    link.download = "QRIS-PHOENIXBORNE-OATH.png";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }

  // ===== BLOK AKSI AWAM =====
  document.addEventListener("contextmenu", e => e.preventDefault());

  document.addEventListener("keydown", e => {
    if (
      e.key === "F12" ||
      (e.ctrlKey && e.key.toLowerCase() === "u") ||
      (e.ctrlKey && e.shiftKey && ["i","j","c"].includes(e.key.toLowerCase()))
    ) {
      e.preventDefault();
    }
  });
</script>
</body>
</html>
